{% extends 'base.html' %}

{% block content %}
<div class="container" style="padding-top: 39px;">
    <div class="row">

        <!--------------------        BARRA LATERAL            ------------------------->

        <div class="col-auto col-md-3" style="margin-top: 50px;padding-right: 45px;">
            <div>

                <!--------------------        FORMULARIO BUSQUEDAS             ------------------------->

                <form
                    style="border-radius: 5px;padding-top: 10px;padding-right: 10px;padding-bottom: 10px;padding-left: 10px;border: 1px solid var(--bs-body-bg) ;border-top-style: solid; "
                    method="POST" action="{% url 'buscar' %}">{% csrf_token %}
                    <h1 class="fs-4 text-center" style="color: var(--bs-gray-100);">buscar</h1>
                    <hr
                        style="background: var(--bs-body-bg);border-width: 1px;border-color: var(--bs-body-bg);color: var(--bs-body-bg);margin-top: 10px;margin-bottom: 10px;">
                    <div class="d-flex d-md-flex d-lg-flex justify-content-end justify-content-md-end align-items-md-center justify-content-lg-end"
                        style="margin-top: 15px;padding-bottom: 7px;">
                        <input class="form-control" type="text" placeholder="búsqueda" name="busqueda" id="busqueda">
                        <button class="btn btn-primary" type="submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>

                <!--------------------        FORMULARIO FILTROS             ------------------------->
                <form
                    style="margin-top: 35px;border-radius: 5px;border: 1px solid var(--bs-body-bg);padding-left: 10px;padding-top: 10px;padding-bottom: 10px;padding-right: 10px;"
                    method="POST" action="{% url 'filtro' %}">{% csrf_token %}

                    {% if casillas %}
                    <h1 class="fs-4 text-center" style="color: var(--bs-gray-100);">filtros&nbsp;&nbsp;</h1>
                    <hr
                        style="background: var(--bs-body-bg);border-width: 1px;border-color: var(--bs-body-bg);color: var(--bs-body-bg);">
                    <h6 style="color: var(--bs-body-bg);padding-left: 10px;">estado</h6>

                    {% if casillas.0 == 'on' %}
                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                            class="form-check-input" type="checkbox" id="Check-1" name="Check-1" checked="">
                        {% else %}
                        <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                class="form-check-input" type="checkbox" id="Check-1" name="Check-1">
                            {% endif %}
                            <label class="form-check-label" for="Check-1">disponible</label>
                        </div>

                        {% if casillas.1 == 'on' %}
                        <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                class="form-check-input" type="checkbox" id="Check-2" name="Check-2" checked="">
                            {% else %}
                            <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                    class="form-check-input" type="checkbox" id="Check-2" name="Check-2">
                                {% endif %}
                                <label class="form-check-label" for="Check-2">prestado</label>
                            </div>


                            <h6 style="color: var(--bs-body-bg);padding: 0px;padding-left: 10px;padding-top: 15px;">
                                categoría</h6>

                            {% if casillas.2 == 'on' %}
                            <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                    class="form-check-input" type="checkbox" id="Check-3" name="Check-3" checked="">
                                {% else %}
                                <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                        class="form-check-input" type="checkbox" id="Check-3" name="Check-3">
                                    {% endif %}
                                    <label class="form-check-label" for="Check-3">computadores</label>
                                </div>

                                {% if casillas.3 == 'on' %}
                                <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                        class="form-check-input" type="checkbox" id="Check-4" name="Check-4" checked="">
                                    {% else %}
                                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                            class="form-check-input" type="checkbox" id="Check-4" name="Check-4">
                                        {% endif %}
                                        <label class="form-check-label" for="Check-4">juegos</label>
                                    </div>

                                    {% if casillas.4 == 'on' %}
                                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                            class="form-check-input" type="checkbox" id="Check-5" name="Check-5" checked="">
                                        {% else %}
                                        <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                                class="form-check-input" type="checkbox" id="Check-5" name="Check-5">
                                            {% endif %}
                                            <label class="form-check-label" for="Check-4">raspberry</label>
                                        </div>

                                        {% if casillas.5 == 'on' %}
                                        <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                                class="form-check-input" type="checkbox" id="Check-6" name="Check-6" checked="">
                                            {% else %}
                                            <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                                    class="form-check-input" type="checkbox" id="Check-6" name="Check-6">
                                                {% endif %}
                                                <label class="form-check-label" for="Check-4">otro</label>
                                            </div>

                                    <div class="d-xl-flex justify-content-xl-center" style="padding-top: 15px;">
                                        <button class="btn btn-primary" type="submit">filtrar</button>
                                    </div>

                                    {% else %}
                                    <h1 class="fs-4 text-center" style="color: var(--bs-gray-100);">
                                        filtros&nbsp;&nbsp;</h1>
                                    <hr
                                        style="background: var(--bs-body-bg);border-width: 1px;border-color: var(--bs-body-bg);color: var(--bs-body-bg);">
                                    <h6 style="color: var(--bs-body-bg);padding-left: 10px;">estado</h6>
                                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                            class="form-check-input" type="checkbox" id="Check-1" name="Check-1"
                                            checked=""><label class="form-check-label" for="Check-1">disponible</label>
                                    </div>
                                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                            class="form-check-input" type="checkbox" id="Check-2" name="Check-2"
                                            checked=""><label class="form-check-label" for="Check-2">prestado</label>
                                    </div>
                                    <h6
                                        style="color: var(--bs-body-bg);padding: 0px;padding-left: 10px;padding-top: 15px;">
                                        categoría</h6>
                                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                            class="form-check-input" type="checkbox" id="Check-3" name="Check-3"
                                            checked=""><label class="form-check-label"
                                            for="Check-3">computadores</label></div>
                                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                            class="form-check-input" type="checkbox" id="Check-4" name="Check-4"
                                            checked=""><label class="form-check-label" for="Check-4">juegos</label>
                                    </div>
                                    <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                        class="form-check-input" type="checkbox" id="Check-5" name="Check-5"
                                        checked=""><label class="form-check-label"
                                        for="Check-3">raspberry</label></div>
                                        <div class="form-check form-switch" style="color: var(--bs-body-bg);"><input
                                            class="form-check-input" type="checkbox" id="Check-6" name="Check-6"
                                            checked=""><label class="form-check-label"
                                            for="Check-3">otro</label></div>
                                    <div class="d-xl-flex justify-content-xl-center" style="padding-top: 15px;">
                                        <button class="btn btn-primary" type="submit">filtrar</button>
                                    </div>
                                    

                                    {% endif %}
                </form>
            </div>
        </div>

        <!--------------------        FIN BARRA LATERAL            ------------------------->


        <!--------------------        SECTOR DERECHO            ------------------------->


        <div class="col-md-9">
            {% if mensaje_alerta %}
            <div class="d-xl-flex justify-content-xl-end">
                <div class="alert alert-danger alert-dismissible" role="alert" style="width: 240.398px;text-align: center;margin-right: 60px;"><button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button><span><strong>usuario no encontrado</strong><br /></span></div>
            </div>
            {% endif%}
            {% if mensaje_prestado %}
            <div class="d-xl-flex justify-content-xl-end">
                <div class="alert alert-success text-center alert-dismissible" role="alert" style="padding-top: 5px;padding-bottom: 5px;margin-right: 65px;min-width: 255px;"><button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button>
                    <h3 class="alert-heading">{{mensaje_prestado.0}}</h3><span class="fs-6"><strong>{{mensaje_prestado.1}}</strong></span>
                </div>
            </div>
            {% endif%}
            <div class="table-responsive" style="border-radius: 5px;border: 1px none var(--bs-body-bg);">

                <!--------------------        TABLA             ------------------------->

                <table class="table table-striped table-dark">
                    <thead>
                        <tr>
                            <th>item</th>
                            <th>categoría</th>
                            <th>estado</th>
                            <th>prestado a...</th>
                            <th>fecha de prestamo</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>

                        <!--------------------        ITERACION DE ITEMS            ------------------------->

                        {% for item in items %}

                        <tr>
                            <td>{{ item.0 }} </td>

                            {% if item.0.ver_categoria == "juego" %}
                            <td><i class="fas fa-gamepad fs-3"></i></td>
                            {% elif item.0.ver_categoria == "computador" %}
                            <td><i class="material-icons fs-2">computer</i></td>
                            {% elif item.0.ver_categoria == "raspberry" %}
                            <td><svg xmlns="http://www.w3.org/2000/svg" viewBox="-52.5 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-2">
                                <!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. -->
                                <path d="M372 232.5l-3.7-6.5c.1-46.4-21.4-65.3-46.5-79.7 7.6-2 15.4-3.6 17.6-13.2 13.1-3.3 15.8-9.4 17.1-15.8 3.4-2.3 14.8-8.7 13.6-19.7 6.4-4.4 10-10.1 8.1-18.1 6.9-7.5 8.7-13.7 5.8-19.4 8.3-10.3 4.6-15.6 1.1-20.9 6.2-11.2.7-23.2-16.6-21.2-6.9-10.1-21.9-7.8-24.2-7.8-2.6-3.2-6-6-16.5-4.7-6.8-6.1-14.4-5-22.3-2.1-9.3-7.3-15.5-1.4-22.6.8C271.6.6 269 5.5 263.5 7.6c-12.3-2.6-16.1 3-22 8.9l-6.9-.1c-18.6 10.8-27.8 32.8-31.1 44.1-3.3-11.3-12.5-33.3-31.1-44.1l-6.9.1c-5.9-5.9-9.7-11.5-22-8.9-5.6-2-8.1-7-19.4-3.4-4.6-1.4-8.9-4.4-13.9-4.3-2.6.1-5.5 1-8.7 3.5-7.9-3-15.5-4-22.3 2.1-10.5-1.3-14 1.4-16.5 4.7-2.3 0-17.3-2.3-24.2 7.8C21.2 16 15.8 28 22 39.2c-3.5 5.4-7.2 10.7 1.1 20.9-2.9 5.7-1.1 11.9 5.8 19.4-1.8 8 1.8 13.7 8.1 18.1-1.2 11 10.2 17.4 13.6 19.7 1.3 6.4 4 12.4 17.1 15.8 2.2 9.5 10 11.2 17.6 13.2-25.1 14.4-46.6 33.3-46.5 79.7l-3.7 6.5c-28.8 17.2-54.7 72.7-14.2 117.7 2.6 14.1 7.1 24.2 11 35.4 5.9 45.2 44.5 66.3 54.6 68.8 14.9 11.2 30.8 21.8 52.2 29.2C159 504.2 181 512 203 512h1c22.1 0 44-7.8 64.2-28.4 21.5-7.4 37.3-18 52.2-29.2 10.2-2.5 48.7-23.6 54.6-68.8 3.9-11.2 8.4-21.3 11-35.4 40.6-45.1 14.7-100.5-14-117.7zm-22.2-8c-1.5 18.7-98.9-65.1-82.1-67.9 45.7-7.5 83.6 19.2 82.1 67.9zm-43 93.1c-24.5 15.8-59.8 5.6-78.8-22.8s-14.6-64.2 9.9-80c24.5-15.8 59.8-5.6 78.8 22.8s14.6 64.2-9.9 80zM238.9 29.3c.8 4.2 1.8 6.8 2.9 7.6 5.4-5.8 9.8-11.7 16.8-17.3 0 3.3-1.7 6.8 2.5 9.4 3.7-5 8.8-9.5 15.5-13.3-3.2 5.6-.6 7.3 1.2 9.6 5.1-4.4 10-8.8 19.4-12.3-2.6 3.1-6.2 6.2-2.4 9.8 5.3-3.3 10.6-6.6 23.1-8.9-2.8 3.1-8.7 6.3-5.1 9.4 6.6-2.5 14-4.4 22.1-5.4-3.9 3.2-7.1 6.3-3.9 8.8 7.1-2.2 16.9-5.1 26.4-2.6l-6 6.1c-.7.8 14.1.6 23.9.8-3.6 5-7.2 9.7-9.3 18.2 1 1 5.8.4 10.4 0-4.7 9.9-12.8 12.3-14.7 16.6 2.9 2.2 6.8 1.6 11.2.1-3.4 6.9-10.4 11.7-16 17.3 1.4 1 3.9 1.6 9.7.9-5.2 5.5-11.4 10.5-18.8 15 1.3 1.5 5.8 1.5 10 1.6-6.7 6.5-15.3 9.9-23.4 14.2 4 2.7 6.9 2.1 10 2.1-5.7 4.7-15.4 7.1-24.4 10 1.7 2.7 3.4 3.4 7.1 4.1-9.5 5.3-23.2 2.9-27 5.6.9 2.7 3.6 4.4 6.7 5.8-15.4.9-57.3-.6-65.4-32.3 15.7-17.3 44.4-37.5 93.7-62.6-38.4 12.8-73 30-102 53.5-34.3-15.9-10.8-55.9 5.8-71.8zm-34.4 114.6c24.2-.3 54.1 17.8 54 34.7-.1 15-21 27.1-53.8 26.9-32.1-.4-53.7-15.2-53.6-29.8 0-11.9 26.2-32.5 53.4-31.8zm-123-12.8c3.7-.7 5.4-1.5 7.1-4.1-9-2.8-18.7-5.3-24.4-10 3.1 0 6 .7 10-2.1-8.1-4.3-16.7-7.7-23.4-14.2 4.2-.1 8.7 0 10-1.6-7.4-4.5-13.6-9.5-18.8-15 5.8.7 8.3.1 9.7-.9-5.6-5.6-12.7-10.4-16-17.3 4.3 1.5 8.3 2 11.2-.1-1.9-4.2-10-6.7-14.7-16.6 4.6.4 9.4 1 10.4 0-2.1-8.5-5.8-13.3-9.3-18.2 9.8-.1 24.6 0 23.9-.8l-6-6.1c9.5-2.5 19.3.4 26.4 2.6 3.2-2.5-.1-5.6-3.9-8.8 8.1 1.1 15.4 2.9 22.1 5.4 3.5-3.1-2.3-6.3-5.1-9.4 12.5 2.3 17.8 5.6 23.1 8.9 3.8-3.6.2-6.7-2.4-9.8 9.4 3.4 14.3 7.9 19.4 12.3 1.7-2.3 4.4-4 1.2-9.6 6.7 3.8 11.8 8.3 15.5 13.3 4.1-2.6 2.5-6.2 2.5-9.4 7 5.6 11.4 11.5 16.8 17.3 1.1-.8 2-3.4 2.9-7.6 16.6 15.9 40.1 55.9 6 71.8-29-23.5-63.6-40.7-102-53.5 49.3 25 78 45.3 93.7 62.6-8 31.8-50 33.2-65.4 32.3 3.1-1.4 5.8-3.2 6.7-5.8-4-2.8-17.6-.4-27.2-5.6zm60.1 24.1c16.8 2.8-80.6 86.5-82.1 67.9-1.5-48.7 36.5-75.5 82.1-67.9zM38.2 342c-23.7-18.8-31.3-73.7 12.6-98.3 26.5-7 9 107.8-12.6 98.3zm91 98.2c-13.3 7.9-45.8 4.7-68.8-27.9-15.5-27.4-13.5-55.2-2.6-63.4 16.3-9.8 41.5 3.4 60.9 25.6 16.9 20 24.6 55.3 10.5 65.7zm-26.4-119.7c-24.5-15.8-28.9-51.6-9.9-80s54.3-38.6 78.8-22.8 28.9 51.6 9.9 80c-19.1 28.4-54.4 38.6-78.8 22.8zM205 496c-29.4 1.2-58.2-23.7-57.8-32.3-.4-12.7 35.8-22.6 59.3-22 23.7-1 55.6 7.5 55.7 18.9.5 11-28.8 35.9-57.2 35.4zm58.9-124.9c.2 29.7-26.2 53.8-58.8 54-32.6.2-59.2-23.8-59.4-53.4v-.6c-.2-29.7 26.2-53.8 58.8-54 32.6-.2 59.2 23.8 59.4 53.4v.6zm82.2 42.7c-25.3 34.6-59.6 35.9-72.3 26.3-13.3-12.4-3.2-50.9 15.1-72 20.9-23.3 43.3-38.5 58.9-26.6 10.5 10.3 16.7 49.1-1.7 72.3zm22.9-73.2c-21.5 9.4-39-105.3-12.6-98.3 43.9 24.7 36.3 79.6 12.6 98.3z"></path>
                            </svg></td>
                            {% elif item.0.ver_categoria == "otro" %}
                            <td><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" class="fs-1" style="padding-left: 0px;margin-right: 0px;margin-left: -3px;">
                                <path d="M10.9759 9C10.9759 9.55228 10.5282 10 9.97589 10C9.42361 10 8.97589 9.55228 8.97589 9C8.97589 8.44771 9.42361 8 9.97589 8C10.5282 8 10.9759 8.44771 10.9759 9Z" fill="currentColor"></path>
                                <path d="M13.9712 10C14.5235 10 14.9712 9.55228 14.9712 9C14.9712 8.44771 14.5235 8 13.9712 8C13.4189 8 12.9712 8.44771 12.9712 9C12.9712 9.55228 13.4189 10 13.9712 10Z" fill="currentColor"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M19 20.9999V10C19 6.13401 15.866 3 12 3C8.13401 3 5 6.13401 5 10V21L7.82846 21L9.24264 19.5858L10.6569 21L13.3433 21L14.7574 19.5858L16.1717 21L19 20.9999ZM17 10C17 7.23858 14.7614 5 12 5C9.23858 5 7 7.23858 7 10V19L9.24264 16.7573L12 19.5147L14.7574 16.7573L17 18.9999V10Z" fill="currentColor"></path>
                            </svg></td>
                            {% else %}
                            <td></td>
                            {% endif %}


                            {% if item.0.disponible == True %}
                            <td>disponible</td>
                            {% else %}
                            <td>prestado</td>
                            {% endif %}

                            {% if item.0.disponible == True %}
                            <td></td>
                            <td></td>
                            {% else %}
                            <td>{{ item.1 }}</td>
                            <td>{{ item.2}}</td>
                            {% endif %}

                            <td class="d-lg-flex justify-content-lg-center">
                                {% if item.0.disponible == True %}
                                <button class="btn btn-success" type="button"
                                    style="padding-right: 18px;padding-left: 18px;"
                                    data-bs-target="#modal-{{item.0.id}}" data-bs-toggle="modal">prestar</button>
                                {% else %}
                                <form method="POST" action="{% url 'devolver' %}">{% csrf_token %}
                                    <input id="itemidd" name="itemidd" type="hidden" value="{{item.0.id}}" placeholder="{{item.0.id}}">
                                    <button class="btn btn-danger" type="submit">devolver</button>
                                </form>
                                {% endif %}
                                <form method="POST" action="{% url 'item_' item.0.id %}">{% csrf_token %}
                                    <input id="itemidd" name="itemidd" type="hidden" value="{{item.0.id}}" placeholder="{{item.0.id}}">
                                    <button class="btn btn-secondary" type="submit"
                                        style="text-align: center;padding-left: 18px;padding-right: 18px;margin-left: 10px;">
                                        <i class="fas fa-info-circle fs-5"></i>
                                    </button>
                                </form>
                            </td>
                        </tr>

                        <!--------------------        MENU MODAL             ------------------------->

                        <div class="modal fade" role="dialog" tabindex="-1" id="modal-{{item.0.id}}">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4 class="modal-title">{{item.0.nombre}}</h4><button type="button"
                                            class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <p>usuario a prestar</p>
                                        <form method="POST" action="{% url 'prestar' %}">{% csrf_token %}
                                            <input class="form-control" type="text" placeholder="rut o rol"
                                                name="user_name" id="user_name" required >
                                            <input id="itemid" name="itemid" type="hidden" value="{{item.0.id}}"
                                                placeholder="{{item.0.id}}">
                                    </div>
                                    <div class="modal-footer"><button class="btn btn-light" type="button"
                                            data-bs-dismiss="modal">cerrar</button><button class="btn btn-success"
                                            type="submit">prestar</button></div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!--------------------        FIN MENU MODAL             ------------------------->

                        <!--------------------        FIN DE ITERACION DE ITEMS             ------------------------->

                        {% endfor %}



                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{% endblock %}